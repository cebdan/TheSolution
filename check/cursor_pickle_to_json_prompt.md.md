# ü§ñ –ü—Ä–æ–º—Ç –¥–ª—è Cursor: –ó–∞–º–µ–Ω–∞ pickle –Ω–∞ JSON –≤ TheSolution CAD

## üìã –ó–ê–î–ê–ß–ê –î–õ–Ø CURSOR

**–ö–æ–Ω—Ç–µ–∫—Å—Ç**: –ü—Ä–æ–µ–∫—Ç TheSolution CAD - —Å–∏—Å—Ç–µ–º–∞ CAD –Ω–∞ –æ—Å–Ω–æ–≤–µ Root Solution –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å Python –∫–ª–∞—Å—Å–∞–º–∏ Solution, SolutionCoordinate –∏ —Å–∏—Å—Ç–µ–º–æ–π —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö.

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**: –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è pickle –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π JSON —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤.

## üéØ –ß–¢–û –ù–£–ñ–ù–û –°–î–ï–õ–ê–¢–¨

### 1. –°–û–ó–î–ê–¢–¨ –°–ò–°–¢–ï–ú–£ –ë–ï–ó–û–ü–ê–°–ù–û–ô –°–ï–†–ò–ê–õ–ò–ó–ê–¶–ò–ò

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `project/safe_serializer.py` —Å –∫–ª–∞—Å—Å–∞–º–∏:

```python
class SolutionJSONEncoder:
    """–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç Solution –æ–±—ä–µ–∫—Ç—ã –≤ JSON-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —Å–ª–æ–≤–∞—Ä–∏"""
    
    @staticmethod
    def solution_to_dict(solution) -> Dict[str, Any]:
        # –î–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å:
        # - –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å Solution 
        # - BoxSolution, SphereSolution, CylinderSolution
        # - AssemblySolution —Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
        # - SolutionCoordinate (x,y,z,a,b,c)
        # - –ò–µ—Ä–∞—Ä—Ö–∏—é parent/children
        # - –°–≤–æ–π—Å—Ç–≤–∞ properties
        # - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (created_at, version, etc)
        pass
    
    @staticmethod  
    def coordinate_to_dict(coordinate) -> Dict[str, float]:
        # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç SolutionCoordinate –≤ –ø—Ä–æ—Å—Ç–æ–π —Å–ª–æ–≤–∞—Ä—å
        pass
    
    @staticmethod
    def project_to_dict(solutions: List, metadata: Dict = None) -> Dict[str, Any]:
        # –°–æ–∑–¥–∞–µ—Ç –ø–æ–ª–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º, –≤–µ—Ä—Å–∏–µ–π, –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º–æ–π
        pass

class SolutionJSONDecoder:
    """–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç JSON –æ–±—Ä–∞—Ç–Ω–æ –≤ Solution –æ–±—ä–µ–∫—Ç—ã"""
    
    @staticmethod
    def dict_to_solution(data: Dict[str, Any], parent=None):
        # –°–æ–∑–¥–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø Solution –Ω–∞ –æ—Å–Ω–æ–≤–µ "type" –ø–æ–ª—è
        # –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ —Å–≤–æ–π—Å—Ç–≤–∞ –∏ —Å–≤—è–∑–∏
        pass
    
    @staticmethod
    def dict_to_project(data: Dict[str, Any]) -> List:
        # –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤–µ—Å—å –ø—Ä–æ–µ–∫—Ç —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Ñ–æ—Ä–º–∞—Ç–∞
        pass

class SafeProjectManager:
    """–û—Å–Ω–æ–≤–Ω–æ–π API –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤"""
    
    @staticmethod
    def save_project(solutions: List, filename: str, metadata: Dict = None) -> bool:
        # –ì–ª–∞–≤–Ω—ã–π –º–µ—Ç–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è - –∑–∞–º–µ–Ω—è–µ—Ç –≤—Å–µ pickle.dump()
        pass
    
    @staticmethod  
    def load_project(filename: str) -> List:
        # –ì–ª–∞–≤–Ω—ã–π –º–µ—Ç–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏ - –∑–∞–º–µ–Ω—è–µ—Ç –≤—Å–µ pickle.load()
        pass
    
    @staticmethod
    def validate_project_file(filename: str) -> bool:
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞ –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ (–¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
        pass
```

### 2. –û–ë–ù–û–í–ò–¢–¨ –°–£–©–ï–°–¢–í–£–Æ–©–ò–ï –§–ê–ô–õ–´

**–ù–∞–π–¥–∏ –∏ –∑–∞–º–µ–Ω–∏ –í–°–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è pickle –≤ –ø—Ä–æ–µ–∫—Ç–µ:**

–í —Ñ–∞–π–ª–∞—Ö –≤–∏–¥–∞:
- `project/project_manager.py` 
- `Root Solution/*/main_*.py`
- `**/file_handler.py`
- `**/save_load.py`

**–ó–∞–º–µ–Ω–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:**
```python
# ‚ùå –£–ë–†–ê–¢–¨:
import pickle
pickle.dump(data, file)
pickle.load(file) 
pickle.dumps(data)
pickle.loads(data)

# ‚úÖ –ó–ê–ú–ï–ù–ò–¢–¨ –ù–ê:
from project.safe_serializer import SafeProjectManager
SafeProjectManager.save_project(solutions, filename)
SafeProjectManager.load_project(filename)
```

### 3. –°–û–ó–î–ê–¢–¨ –¢–ï–°–¢–´

–°–æ–∑–¥–∞–π `tests/test_safe_serialization.py`:

```python
def test_solution_serialization():
    """–¢–µ—Å—Ç —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±–∞–∑–æ–≤–æ–≥–æ Solution"""
    # –°–æ–∑–¥–∞–π Solution –æ–±—ä–µ–∫—Ç
    # –°–µ—Ä–∏–∞–ª–∏–∑—É–π –≤ JSON
    # –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–π –æ–±—Ä–∞—Ç–Ω–æ  
    # –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –≤—Å–µ –ø–æ–ª—è —Å–æ–≤–ø–∞–¥–∞—é—Ç
    pass

def test_coordinate_serialization():
    """–¢–µ—Å—Ç SolutionCoordinate"""
    # –°–æ–∑–¥–∞–π SolutionCoordinate
    # –ü—Ä–æ–≤–µ—Ä—å —Ç–æ—á–Ω–æ—Å—Ç—å float –∑–Ω–∞—á–µ–Ω–∏–π
    pass

def test_hierarchy_serialization():
    """–¢–µ—Å—Ç –∏–µ—Ä–∞—Ä—Ö–∏–∏ parent/children"""
    # –°–æ–∑–¥–∞–π –¥–µ—Ä–µ–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤
    # –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Å–≤—è–∑–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
    pass

def test_complex_project():
    """–¢–µ—Å—Ç —Å–ª–æ–∂–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ Solution"""
    # BoxSolution, SphereSolution, AssemblySolution
    # –°–æ—Ö—Ä–∞–Ω–∏ –∏ –∑–∞–≥—Ä—É–∑–∏
    # –ü—Ä–æ–≤–µ—Ä—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å
    pass

def test_malicious_json():
    """–¢–µ—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ - –ø–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π JSON"""
    # –°–æ–∑–¥–∞–π JSON —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    # –£–±–µ–¥–∏—Å—å —á—Ç–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–¥
    pass

def test_large_file_protection():
    """–¢–µ—Å—Ç –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤"""
    pass

def test_migration_from_pickle():
    """–¢–µ—Å—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ç–∞—Ä—ã—Ö pickle —Ñ–∞–π–ª–æ–≤"""
    pass
```

### 4. –°–û–ó–î–ê–¢–¨ –£–¢–ò–õ–ò–¢–´ –ú–ò–ì–†–ê–¶–ò–ò

–°–æ–∑–¥–∞–π `scripts/migrate_pickle_to_json.py`:

```python
def migrate_project_files(directory: str):
    """–ù–∞–π—Ç–∏ –≤—Å–µ .pickle —Ñ–∞–π–ª—ã –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ .json"""
    # –ù–∞–π—Ç–∏ —Ñ–∞–π–ª—ã *.pickle, *.pkl
    # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ SafeProjectManager
    # –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
    # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
    pass

def validate_migration(old_pickle: str, new_json: str):
    """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ"""
    pass

if __name__ == "__main__":
    # CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏
    pass
```

### 5. –û–ë–ù–û–í–ò–¢–¨ –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ

**–í —Ñ–∞–π–ª–µ `–æ—Ç—á–µ—Ç_—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.md` –¥–æ–±–∞–≤—å —Å–µ–∫—Ü–∏—é:**

```markdown
## üîí –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—É—é —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é (–¥–∞—Ç–∞)

### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ:
- –ó–∞–º–µ–Ω–µ–Ω pickle –Ω–∞ JSON –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–∑–∞–≥—Ä—É–∑–∫–∏
- –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ SafeProjectManager –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –°–æ–∑–¥–∞–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:
- JSON —Ñ–æ—Ä–º–∞—Ç: TheSolution_JSON v1.0
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ Solution –æ–±—ä–µ–∫—Ç–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Å—É–º–º—ã
- –ó–∞—â–∏—Ç–∞ –æ—Ç –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### üìã –§–∞–π–ª—ã:
- `project/safe_serializer.py` - –æ—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- `tests/test_safe_serialization.py` - —Ç–µ—Å—Ç—ã
- `scripts/migrate_pickle_to_json.py` - –º–∏–≥—Ä–∞—Ü–∏—è
```

## üéØ –û–°–û–ë–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø

### –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨:
- ‚úÖ –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π `eval()`, `exec()`, `__import__()`
- ‚úÖ –í–∞–ª–∏–¥–∏—Ä—É–π –í–°–ï –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ  
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π —Ñ–æ—Ä–º–∞—Ç –∏ –≤–µ—Ä—Å–∏—é

### –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–¨:
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏ –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ API
- ‚úÖ –°–¥–µ–ª–∞–π –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ
- ‚úÖ –î–æ–±–∞–≤—å —á–µ—Ç–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

### –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨:  
- ‚úÖ JSON –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫–æ–º–ø–∞–∫—Ç–Ω—ã–º
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- ‚úÖ –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

### –û–¢–õ–ê–î–ö–ê:
- ‚úÖ JSON —Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —á–∏—Ç–∞–µ–º—ã–º–∏
- ‚úÖ –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

## üß™ –ü–†–û–í–ï–†–ò–¢–¨ –†–ï–ó–£–õ–¨–¢–ê–¢

**–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç—ã:**
```bash
python -m pytest tests/test_safe_serialization.py -v
python scripts/migrate_pickle_to_json.py --test
python test_basic_system.py  # –î–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–Ω—å—à–µ
python test_root_solution.py  # –î–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–Ω—å—à–µ
```

**–ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Å–æ–∑–¥–∞–ª–∏—Å—å —Ñ–∞–π–ª—ã:**
- `project/safe_serializer.py`
- `tests/test_safe_serialization.py` 
- `scripts/migrate_pickle_to_json.py`

**–£–±–µ–¥–∏—Å—å —á—Ç–æ –∑–∞–º–µ–Ω–∏–ª–∏—Å—å –∏–º–ø–æ—Ä—Ç—ã pickle –≤–æ –≤—Å–µ—Ö —Ñ–∞–π–ª–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞.**

## üöÄ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ó–ê–î–ê–ß–ò

1. **–°–æ–∑–¥–∞–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** –≤ `examples/save_load_example.py`
2. **–î–æ–±–∞–≤—å –ø–æ–¥–¥–µ—Ä–∂–∫—É** —Ñ–∞–π–ª–æ–≤ `.3d_sol` —á–µ—Ä–µ–∑ JSON
3. **–°–æ–∑–¥–∞–π –≤–∞–ª–∏–¥–∞—Ç–æ—Ä** JSON —Å—Ö–µ–º—ã –¥–ª—è —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞
4. **–î–æ–±–∞–≤—å —Å–∂–∞—Ç–∏–µ** –±–æ–ª—å—à–∏—Ö JSON —Ñ–∞–π–ª–æ–≤ (gzip)

---

**–í–ê–ñ–ù–û**: –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –£–±–µ–¥–∏—Å—å —á—Ç–æ –í–°–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è pickle —É–¥–∞–ª–µ–Ω—ã –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—É—é JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é!